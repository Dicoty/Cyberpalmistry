本项目为华中科技大学遗传学实验课堂，人体皮纹的遗传分析实验中学生的自定研究项目。我们期望利用卷积神经网络来实现AI看手相，主要关注于手相与爱情的相关性（即传统意义上的爱情线），对于所有愿意提供数据的朋友，十分感谢！您为赛博手相学的进步做出了不可磨灭的巨大贡献！

本项目目前处于收集数据的阶段，我们不会收集您与实验无关的个人隐私信息，所形成的数据库也不会公开，请放心填写调查问卷。

本项目为开源项目，实验结果将公布于本地址，欢迎各位前来查看交流。

————————————————————————————————————————————————————————————————

## **喜报：因为最后只收集到53个可用数据，所以模型不出所料地过拟合了♪(^∇^*)！以下内容纯属图一乐。**

本次共训练了三个模型，EfficientnetB0,EfficientnetB3和EfficientnetB7，因为同属于Efficientnet，所以三个模型结构类似，只不过是模型深度和输入图片的大小不一样，如果你想了解更多详细内容可以直接看代码。（至于为什么用Efficientnet，因为我以前跟着[霹雳吧啦Wz](https://space.bilibili.com/18161609 "老师的B站号")老师学的时候正好学到这里orz）

每个模型都训练的50轮，但我只保存了50轮中损失最小和准确率最大的两个模型权重，EfficientnetB0的最小损失为0.122，最大准确率为0.8；EfficientnetB3的最小损失为0.104，最大准确率为0.8；EfficientnetB7的最小损失为0.160，最大准确率为0.8。但从损失和准确率的角度看更大的模型似乎并不能达到更好的效果，接下来我们结合混淆矩阵分析。（没有验证集了，训练和验证都用的同一个数据库，所以这个混淆矩阵大概只是体现模型过拟合的结果，但是反正我们图一乐，不要在意≡ω≡）

**混淆矩阵：**

TP：True Positive，表示被正确预测为正类的样本数量		FP：False Positive，表示被错误预测为正类的概率

FN：False Negative，表示被错误预测为负类的样本数量	TN：True Negatve，表示被正确预测为负类的概率

Accuracy = (TP+TN) / (TP+FP+FN+TN)

Recall = (TP) / (TP+FN)

Precision = (TP) / (TP+FN)

我们获得的数据中，有伴侣:没伴侣 = 16:37

![](../handdataset/confusion_matrix/confusion_matrix.png)

**EfficientnetB0:**
最小损失：
![最小损失](../handdataset/confusion_matrix/B0_loss.png "最小损失")
最大准确率：
![最大准确率](../handdataset/confusion_matrix/B0_acc.png "最大准确率")

**EfficientnetB3:**
最小损失：
![最小损失](../handdataset/confusion_matrix/B3_loss.png "最小损失")
最大准确率：
![最大准确率](../handdataset/confusion_matrix/B3_acc.png "最大准确率")

**EfficientnetB7:**
最小损失：
![最小损失](../handdataset/confusion_matrix/B7_loss.png "最小损失")
最大准确率：
![最大准确率](../handdataset/confusion_matrix/B7_acc.png "最大准确率")

可见更大的模型表现还是要比较小的模型好的，不过B7和B3在这里差距不大，可能是因为已经过拟合了，B3因为模型更小所以在50轮里可以训练得更完全。至于为什么三个模型在50轮里训练过程中的最大准确率都是0.8，大概只是因为训练过程中我只拿了10张图片出来做验证，三个模型在50轮里都能碰到答对8个的时候吧。

关于训练过程损失和准确率的变化，我使用tensorboard进行了记录，放在runs文件夹下，感兴趣的可以自行查看，大概就是loss不断下降，accuracy一开始就挺高，训练之后反而略下降，之后就基本保持在一个水平了，有时又可以突然达到一个比较高的准确率，可能是训练到后面模型过拟合了，不过混淆矩阵呈现出来的准确率最高的模型效果反而比损失最低的模型好，这我就不知道为什么了，毕竟我不是专业的。

最后结果就是这样，其实就我们收集的数据来说还可以预测预测性别，事业，健康之类的，但我懒得搞了。

Ciallo～(∠・ω< )⌒★
